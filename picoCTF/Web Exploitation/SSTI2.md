# SSTI2

## Challenge Description

I made a cool website where you can announce whatever you want! I read about input sanitization, so now I remove any kind of characters that could be a problem :)
I heard templating is a cool and modular way to build web apps! Check out my website here!

## Hints

- Server Side Template Injection
- Why is blacklisting characters a bad idea to sanitize input?

## Solution

Guided by the challenge description, I researched about Server-Side Template Injection (I referred to [this](https://portswigger.net/web-security/server-side-template-injection) )

SSTI or Server-Side Template Injection occurs when user input is embedded in a template in an unsafe manner, allowing attackers to execute code on the server. Different template engines like Jinja2 have specific syntax that can be exploited if not properly sanitized.

I opened the website and tested `{{7*7}}` which returned `49`, confirming Jinja2 template engine

<img width="1919" height="847" alt="image" src="https://github.com/user-attachments/assets/93e6b6fb-36ba-47cd-84fb-be753ea6055e" />

<img width="1916" height="845" alt="image" src="https://github.com/user-attachments/assets/9ba207a5-2b05-4309-bb0c-c46084438d6f" />

The next step was to find the correct payload for which I referred to [this](https://onsecurity.io/article/server-side-template-injection-with-jinja2/). I checked what all characters are blocked by WAF and found that `.`,`|`,`_`,`[]`,`|join` were blocked. Now that I know the blocked characters, I should use the payload `{{request|attr('application')|attr('\x5f\x5fglobals\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fbuiltins\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fimport\x5f\x5f')('os')|attr('popen')('id')|attr('read')()}}` after replacinf `id` with `cat flag` since we need the flag. This payload uses hex encoded underscores to bypass the filter

<img width="1236" height="606" alt="image" src="https://github.com/user-attachments/assets/759fb427-aa35-4b69-88cf-96f3328257cf" />

<img width="1917" height="840" alt="image" src="https://github.com/user-attachments/assets/ad385c04-0eee-4b43-93e3-c7b22db13472" />

Thus, the flag for this challenge is `picoCTF{sst1_f1lt3r_byp4ss_afa6aa72}`
