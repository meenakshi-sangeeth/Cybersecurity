# Forbidden Paths

## Challenge Description

Can you get the flag?
We know that the website files live in /usr/share/nginx/html/ and the flag is at /flag.txt but the website is filtering absolute file paths. Can you get past the filter to read the flag?
Here's the website.

## Thought Process

I opened the attached website which opened to this

![image](https://github.com/user-attachments/assets/49eca9ab-dd30-43d7-81ed-fc99151464ae)

I entered the given "divine-comedy.txt" which opened to this

![image](https://github.com/user-attachments/assets/71f68030-eeb5-4723-a8d3-35f647fb1b20)

The same follows for "oliver-twist.txt" and "the-happy-prince.txt" as well. I figured the flag will be hidden in "flag.txt" so I entered that which gave me

![image](https://github.com/user-attachments/assets/e7aaba2a-872a-463d-92dd-15e3d690edbc)

So now I have to find out a way to open "flag.txt". I read the challenge decription again and it mentions that "the website is filtering absolute file paths". I recollected the concept of absolute file paths because I need to get past the filter to read the flag.
I tried entering "/fag.txt" 

![image](https://github.com/user-attachments/assets/457beedc-5569-415d-a451-1fee92fb6973)

## Solution

After referring to [this](https://owasp.org/www-community/attacks/Path_Traversal) I thought I could use the concept of path traversal to solve this challenge. The ../ attack, commonly referred to as directory traversal attack, is a type of exploit where an attacker manipulates file paths to access directories and files that are outside the intended scope of a web application's file system. The ../ sequence instructs the file system to move up one directory level. By chaining multiple ../ sequences, an attacker can traverse to the parent directories of the applicationâ€™s root and potentially access restricted files.

To confirm if I was going in the right direction, I tried entering `../html/divine-comedy.txt` which did open up to the page that I opened earlier by simply entering "divine-comedy.txt". Thus I entered `../../../../flag.txt` since the path is `/usr/share/nginx/html/` and I have to climb up four directories

![image](https://github.com/user-attachments/assets/0d167308-cb11-4a14-b778-3dcf32a49321)

Thus the flag for this challenge is picoCTF{7h3_p47h_70_5ucc355_e5a6fcbc}
