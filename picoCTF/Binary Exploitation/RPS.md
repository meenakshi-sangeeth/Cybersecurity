# RPS

## Challenge Description

Here's a program that plays rock, paper, scissors against you. I hear something good happens if you win 5 times in a row.
The program's source code with the flag redacted can be downloaded here.
Connect to the program with netcat:
$ nc saturn.picoctf.net 62583

## Hint

How does the program check if you won? 

## Solution

I connected to the program and ran it

```bash
~# nc saturn.picoctf.net 62583
Welcome challenger to the game of Rock, Paper, Scissors
For anyone that beats me 5 times in a row, I will offer up a flag I found
Are you ready?
Type '1' to play a game
Type '2' to exit the program
1
1


Please make your selection (rock/paper/scissors):
rock
rock
You played: rock
The computer played: paper
Seems like you didn't win this time. Play again?
Type '1' to play a game
Type '2' to exit the program
1
1


Please make your selection (rock/paper/scissors):
paper
paper
You played: paper
The computer played: rock
You win! Play again?
Type '1' to play a game
Type '2' to exit the program
1
1


Please make your selection (rock/paper/scissors):
scissors
scissors
You played: scissors
The computer played: scissors
Seems like you didn't win this time. Play again?
```

I looked at the provided source code and noticed the following 

```bash
char* hands[3] = {"rock", "paper", "scissors"};
char* loses[3] = {"paper", "scissors", "rock"};
int computer_turn = rand() % 3;

if (strstr(player_turn, loses[computer_turn])) {
    puts("You win! Play again?");
    return true;
} else {
    puts("Seems like you didn't win this time. Play again?");
    return false;
}
```
From this, it's clear that the program randomly chooses one of `"rock"`, `"paper"`, or `"scissors"`. It uses the `loses` array to determine what beats its current move.
For example, if the program chooses rock (index 0), then loses[0] = "paper" which means the player wins if their move contains "paper". The function `strstr(player_turn, loses[computer_turn]) checks if the player’s input contains the string that beats the computer’s hand. So basically the program doesn't validate if the player's move is legitimate RPS, it just checks if the input contains the string that beats its move. Thus i figured if I enter all three keywords together in the player input (like "rockpaperscissors"), then no matter what the program chooses, the` strstr()` function will always find the losing string inside my input

```bash
Please make your selection (rock/paper/scissors):
rockpaperscissors
rockpaperscissors
You played: rockpaperscissors
The computer played: rock
You win! Play again?
Type '1' to play a game
Type '2' to exit the program
1
1
```

And my theory was right! I repeated this for 5 times and got the flag

```bash
Please make your selection (rock/paper/scissors):
rockpaperscissors
rockpaperscissors
You played: rockpaperscissors
The computer played: rock
You win! Play again?
Congrats, here's the flag!
picoCTF{50M3_3X7R3M3_1UCK_58F0F41B}
```

Thus the flag for this challenge is `picoCTF{50M3_3X7R3M3_1UCK_58F0F41B}`
